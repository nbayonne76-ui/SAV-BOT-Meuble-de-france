# Railway Configuration File
# This file configures how Railway builds and deploys your application

[build]
builder = "DOCKERFILE"
dockerfilePath = "backend/Dockerfile"

[deploy]
startCommand = "uvicorn app.main:app --host 0.0.0.0 --port $PORT --proxy-headers --forwarded-allow-ips '*'"
healthcheckPath = "/health"
healthcheckTimeout = 100
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

# Environment variables template (configure in Railway UI)
# These are placeholders - set actual values in Railway dashboard
[[deploy.environmentVariables]]
name = "OPENAI_API_KEY"
# Value set in Railway UI - REQUIRED

[[deploy.environmentVariables]]
name = "SECRET_KEY"
# Value set in Railway UI - REQUIRED

[[deploy.environmentVariables]]
name = "DATABASE_URL"
# Auto-injected from PostgreSQL service - ${{Postgres.DATABASE_URL}}

[[deploy.environmentVariables]]
name = "REDIS_URL"
# Auto-injected from Redis service - ${{Redis.REDIS_URL}}

[[deploy.environmentVariables]]
name = "PORT"
value = "8000"

[[deploy.environmentVariables]]
name = "DEBUG"
value = "False"

[[deploy.environmentVariables]]
name = "APP_NAME"
value = "Meuble de France Chatbot"

[[deploy.environmentVariables]]
name = "CORS_ORIGINS"
# Update after deployment with frontend URL

[[deploy.environmentVariables]]
name = "ACCESS_TOKEN_EXPIRE_MINUTES"
value = "30"

[[deploy.environmentVariables]]
name = "RATE_LIMIT_DEFAULT"
value = "100/minute"

[[deploy.environmentVariables]]
name = "RATE_LIMIT_AUTH"
value = "5/minute"

[[deploy.environmentVariables]]
name = "MAX_FILE_SIZE"
value = "10485760"

[[deploy.environmentVariables]]
name = "ALLOWED_EXTENSIONS"
value = "jpg,jpeg,png,gif,heic,mp4,mov,avi,webm"
